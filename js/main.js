document.addEventListener("DOMContentLoaded",()=>{let D,T,x=!1;const $=t=>{const e=o=>Array.from(o).reduce((s,i)=>s+i.offsetWidth,0);if(t){const o=e(document.querySelector("#blog-info > a").children),s=e(document.getElementById("menus").children);D=o+s,T=document.getElementById("nav")}const n=window.innerWidth<=768||D>T.offsetWidth-120;T.classList.toggle("hide-menu",n)},R=()=>{$(!0),T.classList.add("show")},k={open:()=>{btf.overflowPaddingR.add(),btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),x=!0},close:()=>{btf.overflowPaddingR.remove(),btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),x=!1}},W=()=>{const t=()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)},e=document.getElementById("scroll-down");e&&btf.addEventListenerPjax(e,"click",t)},U=()=>{const t=GLOBAL_CONFIG.highlight;if(!t)return;const{highlightCopy:e,highlightLang:n,highlightHeightLimit:o,highlightFullpage:s,highlightMacStyle:i,plugin:u}=t,g=GLOBAL_CONFIG_SITE.isHighlightShrink,f=e||n||g!==void 0||s||i,E=u==="highlight.js"?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if(!((f||o)&&E.length))return;const r=u==="prismjs",v=g===!0?"closed":"",L=g!==void 0?'<i class="fas fa-angle-down expand"></i>':"",I=e?'<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>':"",y='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>',h=s?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"",m=(c,a)=>{GLOBAL_CONFIG.Snackbar!==void 0?btf.snackbarShow(a):(c.textContent=a,c.style.opacity=1,setTimeout(()=>{c.style.opacity=0},800))},C=async(c,a)=>{try{await navigator.clipboard.writeText(c),m(a,GLOBAL_CONFIG.copy.success)}catch(p){console.error("Failed to copy: ",p),m(a,GLOBAL_CONFIG.copy.noSupport)}},O=(c,a)=>{const p=c.parentNode;p.classList.add("copy-true");const b=r?"pre code":"table .code pre",F=p.querySelector(b);F&&(C(F.innerText,a.previousElementSibling),p.classList.remove("copy-true"))},l=c=>c.classList.toggle("closed"),d=(c,a)=>{const b=c.closest("figure.highlight").classList.toggle("code-fullpage");document.body.style.overflow=b?"hidden":"",a.classList.toggle("fa-down-left-and-up-right-to-center",b),a.classList.toggle("fa-up-right-and-down-left-from-center",!b)},A=c=>{const a=c.target.classList,p=c.currentTarget;a.contains("expand")?l(p):a.contains("copy-button")?O(p,c.target):a.contains("fullpage-button")&&d(p,c.target)},G=c=>c.currentTarget.classList.toggle("expand-done"),B=c=>{const a=new Map,p=()=>{let w=c;for(;w!==document.body&&w!=null;)window.getComputedStyle(w).display==="none"&&a.set(w,w.getAttribute("style")||""),w=w.parentNode;const S="visibility: hidden !important; display: block !important;";a.forEach((z,ft)=>{ft.setAttribute("style",z?z+";"+S:S)})},b=()=>{a.forEach((w,S)=>{w===""?S.removeAttribute("style"):S.setAttribute("style",w)})};p();const F=c.offsetHeight;return b(),F},M=(c,a)=>{const p=document.createDocumentFragment();if(f){const b=document.createElement("div");b.className=`highlight-tools ${v}`,b.innerHTML=y+L+c+I+h,btf.addEventListenerPjax(b,"click",A),p.appendChild(b)}if(o&&B(a)>o+30){const b=document.createElement("div");b.className="code-expand-btn",b.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(b,"click",G),p.appendChild(b)}r?a.parentNode.insertBefore(p,a):a.insertBefore(p,a.firstChild)};E.forEach(c=>{let a="";if(r&&btf.wrap(c,"figure",{class:"highlight"}),!n){M("",c);return}r?a=c.getAttribute("data-language")||"Code":(a=c.getAttribute("class").split(" ")[1],(a==="plain"||a===void 0)&&(a="Code")),M(`<div class="code-lang">${a}</div>`,c)})},J=()=>{GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(t=>{const e=t.title||t.alt;if(!e)return;const n=document.createElement("div");n.className="img-alt text-center",n.textContent=e,t.insertAdjacentElement("afterend",n)})},Y=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},K=async t=>{try{return await(await fetch(t)).json()}catch(e){return console.error("Failed to fetch URL:",e),[]}},V=(t,e,n)=>{const{isButton:o,limit:s,firstLimit:i,tabs:u}=n,g=e.length,f=Math.ceil((g-i)/s+1),E={gap:5,isConstantSize:!0,sizeRange:[150,600],useTransform:!0},r=new InfiniteGrid.JustifiedInfiniteGrid(t,E);let v=!1;const L=l=>l&&l.replace(/"/g,"&quot;")||"",I=l=>{const d=l.alt?`alt="${L(l.alt)}"`:"",A=l.title?`title="${L(l.title)}"`:"";return`<div class="item">
        <img src="${l.url}" data-grid-maintained-target="true" ${d} ${A} />
      </div>`},y=(l,d,A=!1)=>{const G=A?(l-1)*d:(l-2)*d+i;return e.slice(G,G+d).map(I)},h=l=>{const d=document.createElement("button");d.innerHTML=`${GLOBAL_CONFIG.infinitegrid.buttonText}<i class="fa-solid fa-arrow-down"></i>`,d.addEventListener("click",()=>{d.remove(),btf.setLoading.add(l),m(r.getGroups().length+1,s)},{once:!0}),l.insertAdjacentElement("afterend",d)},m=(l,d,A)=>{r.append(y(l,d,A),l)},C=l=>{if(u){const B=t.parentNode;v&&(B.style.visibility="visible"),t.offsetHeight===0&&(B.style.visibility="hidden",v=!0)}const{updated:d,isResize:A,mounted:G}=l;if(!(!d.length||!G.length||A)){if(btf.loadLightbox(t.querySelectorAll("img:not(.medium-zoom-image)")),r.getGroups().length===f){btf.setLoading.remove(t),!u&&r.off("renderComplete",C);return}o&&(btf.setLoading.remove(t),h(t))}},O=btf.debounce(l=>{const d=(+l.groupKey||0)+1;d===1?m(d,i,!0):m(d,s),d===f&&r.off("requestAppend",O)},300);btf.setLoading.add(t),r.on("renderComplete",C),o?m(1,i,!0):(r.on("requestAppend",O),r.renderItems()),btf.addGlobalFn("pjaxSendOnce",()=>r.destroy())},N=async(t,e=!1)=>{if(!t.length)return;const n=async()=>{for(const o of t){if(btf.isHidden(o)||o.classList.contains("loaded"))continue;const s={isButton:o.getAttribute("data-button")==="true",limit:parseInt(o.getAttribute("data-limit"),10),firstLimit:parseInt(o.getAttribute("data-first"),10),tabs:e},i=o.firstElementChild,u=i.textContent;i.textContent="",o.classList.add("loaded");try{const g=o.getAttribute("data-type")==="url"?await K(u):JSON.parse(u);V(i,g,s)}catch(g){console.error("Gallery data parsing failed:",g)}}};typeof InfiniteGrid=="function"?await n():(await btf.getScript(GLOBAL_CONFIG.infinitegrid.js),await n())},Q=t=>{const e=btf.getScrollPercent(t,document.body),n=document.getElementById("go-up");e<95?(n.classList.add("show-percent"),n.querySelector(".scroll-percent").textContent=e):n.classList.remove("show-percent")},X=()=>{const t=document.getElementById("rightside"),e=window.innerHeight+56;let n=0;const o=document.getElementById("page-header"),s=typeof chatBtn<"u",i=GLOBAL_CONFIG.percent.rightside,u=()=>document.body.scrollHeight<=e?(t.classList.add("rightside-show"),!0):!1;if(u())return;const g=r=>{const v=r>n;return n=r,v};let f="";const E=btf.throttle(()=>{const r=window.scrollY||document.documentElement.scrollTop,v=g(r);r>56?(f===""&&(o.classList.add("nav-fixed"),t.classList.add("rightside-show")),v?f!=="down"&&(o.classList.remove("nav-visible"),s&&window.chatBtn.hide(),f="down"):f!=="up"&&(o.classList.add("nav-visible"),s&&window.chatBtn.show(),f="up")):(f="",r===0&&o.classList.remove("nav-fixed","nav-visible"),t.classList.remove("rightside-show")),i&&Q(r),u()},300);btf.addEventListenerPjax(window,"scroll",E,{passive:!0})},Z=()=>{const t=GLOBAL_CONFIG_SITE.isToc,e=GLOBAL_CONFIG.isAnchor,n=document.getElementById("article-container");if(!(n&&(t||e)))return;let o,s,i,u,g;if(t){const L=document.getElementById("card-toc");s=L.querySelector(".toc-content"),o=s.querySelectorAll(".toc-link"),u=L.querySelector(".toc-percentage"),g=s.classList.contains("is-expand");const I=y=>{const h=y.target.closest(".toc-link");h&&(y.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(h.getAttribute("href")).replace("#",""))),300),window.innerWidth<900&&L.classList.remove("open"))};btf.addEventListenerPjax(s,"click",I),i=y=>{const h=s.clientHeight,m=y.offsetTop,C=y.clientHeight,O=s.scrollTop,l=m-O,d=(h-C)/2;l!==d&&(s.scrollTop=O+(l-d))},s.style.display="block"}const f=n.querySelectorAll("h1,h2,h3,h4,h5,h6");let E="";const r=L=>{if(L===0)return!1;let I="",y="";for(let h=0;h<f.length;h++){const m=f[h];if(L>btf.getEleTop(m)-80){const C=m.id;I=C?"#"+encodeURI(C):"",y=h}else break}if(E!==y&&(e&&btf.updateAnchor(I),E=y,t&&(s.querySelectorAll(".active").forEach(h=>h.classList.remove("active")),I))){const h=o[y];if(h.classList.add("active"),setTimeout(()=>i(h),0),!g){let m=h.parentNode;for(;!m.matches(".toc");)m.matches("li")&&m.classList.add("active"),m=m.parentNode}}},v=btf.throttle(()=>{const L=window.scrollY||document.documentElement.scrollTop;t&&GLOBAL_CONFIG.percent.toc&&(u.textContent=btf.getScrollPercent(L,n)),r(L)},100);btf.addEventListenerPjax(window,"scroll",v,{passive:!0})},_=t=>{const n=(window.globalFn||{}).themeChange||{};n&&Object.keys(n).forEach(o=>{const s=n[o];["disqus","disqusjs"].includes(o)?setTimeout(()=>s(t),300):s(t)})},P={readmode:()=>{const t=document.body,e=document.createElement("button"),n=()=>{t.classList.remove("read-mode"),e.remove(),e.removeEventListener("click",n)};t.classList.add("read-mode"),e.type="button",e.className="fas fa-sign-out-alt exit-readmode",e.addEventListener("click",n),t.appendChild(e)},darkmode:()=>{const t=document.documentElement.getAttribute("data-theme")==="dark"?"light":"dark";t==="dark"?(btf.activateDarkMode(),GLOBAL_CONFIG.Snackbar!==void 0&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(btf.activateLightMode(),GLOBAL_CONFIG.Snackbar!==void 0&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),btf.saveToLocal.set("theme",t,2),_(t)},"rightside-config":t=>{const e=t.firstElementChild;e.classList.contains("show")&&(e.classList.add("status"),setTimeout(()=>{e.classList.remove("status")},300)),e.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{const t=document.documentElement.classList,e=t.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",e,2),t.toggle("hide-aside")},"mobile-toc-button":(t,e)=>{const n=document.getElementById("card-toc");n.style.transition="transform 0.3s ease-in-out";const o=n.clientHeight,s=e.getBoundingClientRect(),i=window.innerHeight-s.bottom-30;o>i&&(n.style.transformOrigin=`right ${o-i-s.height/2}px`),n.classList.toggle("open"),n.addEventListener("transitionend",()=>{n.style.cssText=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}};document.getElementById("rightside").addEventListener("click",t=>{const e=t.target.closest("[id]");e&&P[e.id]&&P[e.id](t.currentTarget,e)});const tt=()=>{const t=n=>{const o=n.target.closest(".site-page.group");o&&o.classList.toggle("hide")},e=document.querySelector("#sidebar-menus .menus_items");e&&e.addEventListener("click",t)},et=()=>{const t=document.getElementById("toggle-menu");t&&btf.addEventListenerPjax(t,"click",()=>{k.open()})},nt=()=>{const{limitCount:t,languages:e}=GLOBAL_CONFIG.copyright,n=o=>{o.preventDefault();const s=window.getSelection(0).toString();let i=s;return s.length>t&&(i=`${s}


${e.author}
${e.link}${window.location.href}
${e.source}
${e.info}`),o.clipboardData?o.clipboardData.setData("text",i):window.clipboardData.setData("text",i)};document.body.addEventListener("copy",n)},ot=()=>{const t=document.getElementById("runtimeshow");if(t){const e=t.getAttribute("data-publishDate");t.textContent=`${btf.diffDate(e)} ${GLOBAL_CONFIG.runtime}`}},st=()=>{const t=document.getElementById("last-push-date");if(t){const e=t.getAttribute("data-lastPushDate");t.textContent=btf.diffDate(e,!0)}},it=()=>{const t=document.querySelectorAll("#article-container table");t.length&&t.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})},at=()=>{const t=document.querySelectorAll("#article-container .hide-button");t.length&&t.forEach(e=>e.addEventListener("click",n=>{const o=n.currentTarget;o.classList.add("open"),N(o.nextElementSibling.querySelectorAll(".gallery-container"))},{once:!0}))},ct=()=>{const t=document.querySelectorAll("#article-container .tabs");if(!t.length)return;const e=(s,i)=>{s.forEach((u,g)=>{u.classList.toggle("active",g===i)})},n=s=>{const i=s.target.closest("button");if(!i||i.classList.contains("active"))return;const u=[...s.currentTarget.children],g=[...s.currentTarget.nextElementSibling.children],f=u.indexOf(i);e(u,f),s.currentTarget.classList.remove("no-default"),e(g,f),N(g[f].querySelectorAll(".gallery-container"),!0)},o=s=>i=>{i.target.closest("button")&&btf.scrollToDest(btf.getEleTop(s),300)};t.forEach(s=>{btf.addEventListenerPjax(s.firstElementChild,"click",n),btf.addEventListenerPjax(s.lastElementChild,"click",o(s))})},lt=()=>{const t=document.querySelector("#aside-cat-list.expandBtn");if(!t)return;const e=n=>{const o=n.target;o.nodeName==="I"&&(n.preventDefault(),o.parentNode.classList.toggle("expand"))};btf.addEventListenerPjax(t,"click",e,!0)},rt=()=>{const t=document.getElementById("post-outdate-notice");if(!t)return;const{limitDay:e,messagePrev:n,messageNext:o,postUpdate:s}=JSON.parse(t.getAttribute("data")),i=btf.diffDate(s);i>=e&&(t.textContent=`${n} ${i} ${o}`,t.hidden=!1)},dt=()=>{window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src",callback_loading:t=>{t.style.opacity="0",t.style.transition="opacity 0.3s ease"},callback_loaded:t=>{t.style.opacity="1",t.closest(".recent-post-item")&&(t.closest(".recent-post-item").style.minHeight="auto")},callback_error:t=>{t.style.opacity="0.5"}}),btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")},q=t=>{t.forEach(e=>{e.textContent=btf.diffDate(e.getAttribute("datetime"),!0),e.style.display="inline"})},ut=()=>{const t=document.getElementById("recent-posts");if(!(t&&t.classList.contains("masonry")))return;const e=()=>{const n=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:!0,useResizeObserver:!0});n.renderItems(),btf.addGlobalFn("pjaxCompleteOnce",()=>{n.destroy()},"removeJustifiedIndexPostUI")};typeof InfiniteGrid=="function"?e():btf.getScript(`${GLOBAL_CONFIG.infinitegrid.js}`).then(e)},gt=()=>{window.addEventListener("resize",()=>{$(!1),x&&btf.isHidden(document.getElementById("toggle-menu"))&&k.close()});const t=document.getElementById("menu-mask");t&&t.addEventListener("click",()=>{k.close()}),tt(),GLOBAL_CONFIG.islazyloadPlugin&&dt(),GLOBAL_CONFIG.copyright!==void 0&&nt(),addPreloadHints(),GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{btf.saveToLocal.get("theme")===void 0&&(e.matches?_("dark"):_("light"))})},H=()=>{U(),J(),N(document.querySelectorAll("#article-container .gallery-container")),Y(),Z(),it(),at(),ct()},j=()=>{R(),ut(),GLOBAL_CONFIG_SITE.pageType==="post"?(rt(),GLOBAL_CONFIG.relativeDate.post&&q(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&q(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&ot(),st(),lt()),GLOBAL_CONFIG_SITE.pageType==="home"&&W(),X(),H(),GLOBAL_CONFIG_SITE.pageType!=="shuoshuo"&&btf.switchComments(document),et()};btf.addGlobalFn("pjaxComplete",j,"refreshFn"),j(),gt(),window.addEventListener("hexo-blog-decrypt",t=>{H(),window.translateFn.translateInitialization(),Object.values(window.globalFn.encrypt).forEach(e=>{e()})})});
